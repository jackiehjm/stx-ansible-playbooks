---
#
# Copyright (c) 2021-2023 Wind River Systems, Inc.
#
# SPDX-License-Identifier: Apache-2.0
#

- hosts: all
  gather_facts: no

  vars_files:
    - vars/common/main.yml
    - host_vars/rehome-subcloud/default.yml

  roles:
    - common/prepare-env
    - common/validate-target
    - rehome-subcloud/validate-before-rehome
    - common/check-services-status
    - rehome-subcloud/prepare-env
    - rehome-subcloud/update-ca-cert
    - rehome-subcloud/update-k8s-root-ca
    - rehome-subcloud/update-network-config
    - common/update-sc-cert
    - { role: rehome-subcloud/update-keystone-data, become: yes }
    - common/check-services-status
